@page "/products/delete/{id:int}"
@using WebApp.Data
@rendermode InteractiveServer
@inject AppDbContext Db
@inject NavigationManager Nav

<h3>Delete product record</h3>

@if (product == null)
{
    <p><em>読み込み中...</em></p>
}
else
{
    <div class="alert alert-warning">
         Delete <strong>@product.brand</strong> ？ Please make sure!
    </div>

    <div class="mt-3">
        <button class="btn btn-danger me-2" @onclick="DeleteProduct">Delete</button>
        <button class="btn btn-secondary" @onclick="GoBack">Cancel</button>
    </div>
}

@code {
    [Parameter] public int id { get; set; }

    private Product? product;

    protected override async Task OnInitializedAsync()
    {
        product = await Db.Products.FindAsync(id);
    }

    private async Task DeleteProduct()
    {
        Db.Products.Remove(product!);
        await Db.SaveChangesAsync();
        Nav.NavigateTo("/products");
    }

    private void GoBack()
    {
        Nav.NavigateTo("/products");
    }

}