@page "/products/delete/{id:int}"
@rendermode InteractiveServer
@using WebApp.Data
@inject AppDbContext Db
@inject NavigationManager Nav

<h3>製品情報の削除</h3>

@if (product == null)
{
    <p><em>読み込み中...</em></p>
}
else
{
    <div class="alert alert-warning">
        本当に <strong>@product.brand</strong> を削除しますか？
    </div>

    <div class="mt-3">
        <button class="btn btn-danger me-2" @onclick="DeleteProduct">削除</button>
        <button class="btn btn-secondary" @onclick="GoBack">キャンセル</button>
    </div>
}

@code {
    [Parameter]
    public int id { get; set; }

    private Product? product;

    protected override async Task OnInitializedAsync()
    {
        product = await Db.Products.FindAsync(id);
    }

    private async Task DeleteProduct()
    {
        Db.Products.Remove(product!);
        await Db.SaveChangesAsync();
        Nav.NavigateTo("/products");
    }

    private void GoBack()
    {
        Nav.NavigateTo("/products");
    }
}